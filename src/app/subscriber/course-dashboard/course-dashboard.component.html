@if(showContent){
<section class="content" [@fadeIn]>
  @if (loading) {
  <div class="overlay"></div>
  <div class="animToast courseLoader loading">
    <h5>{{loadingText}}</h5>
    <h6 class="col-grey">{{ courseItem?.title ? 'Fetching '+courseItem?.title+' Subjects': 'Fetching Details'}} </h6>
    <hr class="dim-divider">
    <!-- Stacked subject image loading effect -->
    @if (courseItem && courseItem?.subjects) {
    <div class="image-group">
      @for (item of courseItem?.subjects; track item) {
      <img [src]="item.image ?? 'assets/images/tech/placeholder.png'" class="floating" [alt]="item.title">
      }
    </div>
    }
    <hr class="dim-divider">
    <h6 class="col-grey">Please wait</h6>
  </div>
  }
  @if (!loading && courseItem) {
  <div class="content-block">

    <!-- Should remove below code block -->
    <div class="row m-t-20 match-height clearfix">
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
        @if (!userData?.userDesignation?.title) {
        <app-congratulations-card [user]="userData"></app-congratulations-card>
        }
        @if (!userData?.userDesignation?.title) {
        <app-medal-card [userName]="'Hi '+userData?.firstName +'!'"
          [message]="'Up-Skill and Evaluate Skills in '+courseItem?.title+'.'"></app-medal-card>
        }
      </div>
    </div>

    <div class="row match-height m-t-10 clearfix">
      <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12">
        <div class="card">
          <div class="m-b-20">
            <div class="contact-grid">
              <div class="profile-header bg-dark">
                <div class="user-name">{{userData?.firstName}} {{userData?.lastName}}</div>
                @if (userData?.userDesignation) {
                <div class="name-center">{{ userData?.userDesignation?.title }}</div>
                }@else{
                <div class="name-center">New Joiner</div>
                <small class="miniTxt">Let us know your Tech Career Preference</small>
                }
              </div>
              <img src="assets/images/users/user.jpg" class="user-img" alt="{{userData?.firstName}}">
              <p>
                {{userData?.country}}
              </p>
            </div>
            <div class="text-center p-t-20">
              <!-- <small>Subjects in {{courseItem.title}} roles</small> -->
              <h4 class="name-center">{{courseItem.title}}</h4>
              @if (courseItem && courseItem?.subjects) {
              <ul class="list-unstyled order-list m-b-0">
                @for (item of courseItem?.subjects; track item) {
                <li class="avatar avatar-sm">
                  <img class="rounded-circle" [src]="item.image" alt="{{item.title}}">
                </li>
                }
              </ul>
              }
              <hr class="dim-divider">
              <button mat-stroked-button (click)="viewProfile()" color="primary">
                <i class="material-icons">autorenew</i> &nbsp;View Profile</button>
            </div>
          </div>
        </div>
        <ng-container *ngTemplateOutlet="courseEnroll"></ng-container>
        <ng-container *ngTemplateOutlet="courseAssessments"></ng-container>
        <ng-container *ngTemplateOutlet="courseCertification"></ng-container>
        <ng-container *ngTemplateOutlet="courseAssistant"></ng-container>
      </div>
      <div class="col-xl-8 col-lg-8 col-md-8 col-sm-12">
        <ng-container *ngTemplateOutlet="courseSubjectSummary"></ng-container>
      </div>
    </div>

    <div class="row m-t-0 match-height clearfix">
      <div class="col-12">
        <p>I am a bottom bar. What should be hosted here?</p>
      </div>
    </div>

  </div>
  }
</section>
}

<ng-template #courseSubjectSummary>
  <mat-tab-group mat-align-tabs="start" class="m-t-0">
    <mat-tab label="In Progress">
      <div class="row text-center m-t-20 clearfix">
        @if (getAttemptedSubjects() && getAttemptedSubjects()?.length > 0) {
        @for (item of getAttemptedSubjects(); track item) {
        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
          <app-subject-tracker-card [user]="userData" [item]="item"
            (launchSubjectExplorer)="launchSubjectExplorer($event)"
            (takeQuiz)="openQuizLauncher(item)"></app-subject-tracker-card>
        </div>
        }
        }@else{
        <div class="col-12 m-t-20">
          <p class="col-grey">No subjects in progress yet. Start with a subject to get going!</p>
        </div>
        }
      </div>
    </mat-tab>
    <mat-tab label="To Start">
      <div class="row text-center m-t-20 clearfix">
        @if (getNotAttemptedSubjects() && getNotAttemptedSubjects()?.length > 0) {
        @for (item of getNotAttemptedSubjects(); track item) {
        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12">
          <app-subject-tracker-card [user]="userData" [item]="item"
            (launchSubjectExplorer)="launchSubjectExplorer($event)"
            (takeQuiz)="openQuizLauncher(item)"></app-subject-tracker-card>
        </div>
        }
        }@else{
        <div class="col-12 m-t-20">
          <p class="col-grey">All subjects have been started. Keep up the good work!</p>
        </div>
        }
      </div>
    </mat-tab>
  </mat-tab-group>
</ng-template>

<ng-template #courseCertification>
  <mat-card>
    <mat-card-header class="header-style">
      <mat-card-title>Check Certifications</mat-card-title>
    </mat-card-header>
    <mat-card-content>
       <div class="no-data-container text-center">
    <img src="assets/images/icons/student.png" class="loadingIcon m-t-20" />
    <h6 class="col-grey">Keep Exploring</h6>
    <small>Your performance and eligibility for certifications will be updated as you progress.</small>
  </div>
    </mat-card-content>
  </mat-card>
</ng-template>

<ng-template #courseAssessments>
  <mat-card>
    <mat-card-header class="header-style">
      <mat-card-title>Course Assessments</mat-card-title>
    </mat-card-header>
    <mat-card-content>
       <div class="no-data-container11 text-center">
    <img src="assets/images/icons/certificate.png" class="loadingIcon m-t-20" />
    <h6 class="col-grey">{{courseItem?.title}}</h6>
    <small>You have not taken any assessment yet.</small>
  </div>
    </mat-card-content>
  </mat-card>
</ng-template>

<ng-template #courseAssistant>
  <mat-card>
    <mat-card-header class="header-style">
      <mat-card-title>Welcome {{userData?.firstName}}</mat-card-title>
    </mat-card-header>
    <mat-card-content>
        <div class="text-center m-t-20 m-b-20">
          <h6 class="text-center font-20 m-b-10">
            <span class="col-dark m-t-10">How are you doing as {{userData?.userDesignation?.title}} ?</span>
          </h6>
          @if (!(userData?.designation)) {
          <small class="font-12 m-b-10">Aspiring to become {{courseItem.title}}?</small>

          <button mat-stroked-button (click)="onSubscribe(courseItem)" class="btn" rippleEffect>
            <i class="material-icons">autorenew</i> &nbsp;Enroll as Committed Learner</button>
          }

          <button mat-stroked-button (click)="goToCourses()" color="primary">
            <i class="material-icons">autorenew</i> &nbsp;Explore Other Skill Bundles</button>

          @if (userData?.designation && courseItem && userData?.designation !== courseItem?.id) {
          <hr class="dim-divider">
          <div class="font-12 m-b-10">Are you looking to switch your current designation to {{courseItem.title}}?</div>
          <button mat-flat-button (click)="onSubscribe(courseItem)" color="primary">
            <i class="material-icons">card_membership</i> Get Access</button>
          }
        </div>
    </mat-card-content>
  </mat-card>
</ng-template>


<ng-template #courseEnroll>
  <mat-card>
    <mat-card-header class="header-style">
      <mat-card-title>Enroll Now</mat-card-title>
    </mat-card-header>
    <mat-card-content>
       <div class="no-data-container11 text-center">
    <img src="assets/images/icons/hinting.gif" class="loadingIcon m-t-20" />
    <h6 class="col-grey">Ke</h6>
    <small>Your timeline, goals and rewards will appear as you progress.</small>
  </div>
    </mat-card-content>
  </mat-card>
</ng-template>