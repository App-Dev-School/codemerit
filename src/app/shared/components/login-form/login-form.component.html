@if(!submitted){
<div class="form-section">
    <div class="auth-wrapper">
        <div class="loginHeader text-center">
            <div class="text-center mb-3" routerLink="/app/welcome">
                <img src="./../../../assets/images/logo.png" alt="codemerit" class="logo animEntry" />
            </div>
            @if (data && data?.title) {
            <h6 class="welcome-msg text-center"> {{data?.title}} </h6>
            }@else {
            <h6 class="welcome-msg text-center"> isNewUser ? 'Create CodeMerit Account' : 'Login to your CodeMerit Account' </h6>
            }

            @if (data && data?.message) {
            <p class="auth-signup-text text-center">{{data?.message}}</p>
            }@else {
            <p class="auth-signup-text text-center">
                {{ isNewUser ? 'Quick Register to get Started' : 'Access your personalized Learning and Skill Assessment Dashboard'}}
            </p>
            }
        </div>

        @if (isNewUser) {
        <form [@fadeIn] class="validate-form" [formGroup]="authForm" (ngSubmit)="onSubmit()">
            <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>First Name</mat-label>
                        <input matInput formControlName="firstName" required>
                        @if (authForm.get('firstName')!.hasError('required')) {
                        <mat-error>
                            First name is required
                        </mat-error>
                        }
                    </mat-form-field>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Last Name</mat-label>
                        <input matInput formControlName="lastName">
                        @if (authForm.get('lastName')!.hasError('required')) {
                        <mat-error>
                            Last name is required
                        </mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-12col-lg-12 col-md-12 col-sm-12">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Email</mat-label>
                        <input matInput formControlName="email" required>
                        <mat-icon class="material-icons-outlined color-icon p-3" matSuffix>mail</mat-icon>
                        @if (authForm.get('email')!.hasError('required') || authForm.get('email')!.touched) {
                        <mat-error>
                            Please enter a valid email address
                        </mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>

            @if (!data) {
            <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>City</mat-label>
                        <input matInput formControlName="city" required>
                        <mat-icon class="material-icons-outlined color-icon p-3" matSuffix>location_city</mat-icon>
                        @if (authForm.get('city')!.hasError('required')) {
                        <mat-error>
                            Please let us know your city.
                        </mat-error>
                        }
                    </mat-form-field>
                </div>

                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Country</mat-label>
                        <input matInput formControlName="country" type="text" [matAutocomplete]="autoCountry" required>
                        <mat-icon class="material-icons-outlined color-icon p-3" matSuffix>globe</mat-icon>
                        <mat-autocomplete #autoCountry="matAutocomplete" [displayWith]="displayCountry">
                            @for (country of filteredCountries | async; track country) {
                            <mat-option [value]="country.name">
                                {{country.name}}
                            </mat-option>
                            }
                        </mat-autocomplete>

                        @if (authForm.get('country')!.hasError('required')) {
                        <mat-error>
                            Please let us know your country.
                        </mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>

            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                    <mat-form-field class="example-full-width">
                        <mat-label>What describes you best?</mat-label>
                        <input type="text" matInput formControlName="about" [matAutocomplete]="auto">
                        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayRole">
                            @for (option of filteredOptions | async; track option) {
                            <mat-option [value]="option.label">
                                {{option.label}}
                            </mat-option>
                            }
                        </mat-autocomplete>
                    </mat-form-field>
                </div>
            </div>
            }


            <div class="container-auth-form-btn">
                <button mat-flat-button color="accent" class="auth-form-btn" [disabled]="!authForm.valid || submitted"
                    type="submit">
                    Register
                </button>
            </div>
        </form>
       }@else{
         <form [@fadeIn] class="validate-form" [formGroup]="loginForm" (ngSubmit)="onLoginSubmit()">
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>E-mail</mat-label>
                        <input matInput formControlName="username" />
                        <mat-icon class="material-icons-outlined p-3" matSuffix>face</mat-icon>
                        @if (loginForm.get('username')!.hasError('required')) {
                        <mat-error>
                            E-mail is required
                        </mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-12col-lg-12 col-md-12 col-sm-12 mb-2">
                    <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>Password</mat-label>
                        <input matInput [type]="hide ? 'password' : 'text'" formControlName="password">
                        <mat-icon class="material-icons-outlined pwd-toggle p-3" matSuffix (click)="hide = !hide">
                            {{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                        @if (loginForm.get('password')!.hasError('required')) {
                        <mat-error>
                            Password is required
                        </mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-5">
                <div class="form-check">
                    <label class="form-check-label">
                        <input class="form-check-input" type="checkbox" value=""> Remember me
                        <span class="form-check-sign">
                            <span class="check"></span>
                        </span>
                    </label>
                </div>
                <a class="txt1" routerLink="/authentication/forgot-password">Forgot Password?</a>
            </div>
            @if (error) {
            <div class="alert alert-danger mt-3 mb-3">{{error}}</div>
            }
            <div class="container-auth-form-btn">
                <div style="text-align:center">
                    <button mat-flat-button color="accent" [class.auth-spinner]="loading" [disabled]="loading"
                        class="auth-form-btn" [disabled]="!loginForm.valid " type="submit">Login</button>
                </div>  
            </div>
        </form>
    }

        @if (isNewUser) {
        <h6 class="social-login-title">OR</h6>
        <div class="text-center m-b-10">
            <h6 class="link-msg"> Already Registered? <span class="sign-up-link" (click)="onLoginLinkClick()">
                    Login here
                </span></h6>
        </div>
        }@else{
        <h6 class="social-login-title">OR</h6>
        <div style="text-align:center">
            <h6 class="link-msg"> New to CodeMerit ?
                <span class="sign-up-link" (click)="onRegisterLinkClick()">
                    Register Now
                </span>
            </h6>
        </div>
        }

        @if (data && data.action) {
        <div class="text-center m-t-20">
            <button (click)="dismiss(null)" mat-flat-button color="accent" style="background-color:#e91e63;">
                {{data.action}}</button>
        </div>
        }
    </div>
</div>
}@else{
<div class="loading text-center">
    <img src="assets/images/icons/cube.gif" class="loader" alt="Authenticating">
    @if (isNewUser) {
    <h5>Registering Account</h5>
    <h6>Please wait a moment</h6>
    }@else{
    <h5>Authenticating User</h5>
    <h6>Please wait ...</h6>
    }
</div>
}