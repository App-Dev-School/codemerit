<div class="auth-container">
  <div class="auth-main">
    <div class="quiz-container d-flex flex-column vh-100">
      <!-- HEADER -->
      @if (quiz) {
      <mat-toolbar color="primary" class="toolbar justify-content-between" [class.warning]="warningActive">
        <div class="d-flex align-items-center">
          <img [src]="quiz.subject_icon" alt="icon" class="subject-icon me-2">
          <span class="quiz-title">{{ quiz.title }}</span>
        </div>

        <div class="d-flex align-items-center">
          <img src="assets/images/icons/ic_watch.png" class="timerIcon" alt="timer">

          <cd-timer #timerRef [countdown]="true" [startTime]="quizDuration" [omitZero]="true" maxTimeUnit="minute"
            [autoStart]="true" [callTick]="true" format="ms" (onTick)="onTick($event)" (onComplete)="onTimerComplete()">
          </cd-timer>
        </div>
      </mat-toolbar>
      }

      <!-- Screen Overlay -->
      @if (showWarningToast) {
      <div class="overlay"></div>
      <div class="warning-toast">
        ⚠️ 1 Minute Left!
      </div>
      }

      <!-- MAIN CONTENT (Swiper) -->
      <div class="flex-grow-1 overflow-hidden">
        @if (questions?.length > 0) {
        <swiper-container #swiperEx slides-per-view="1" space-between="10" allow-touch-move="false" class="h-100">

          @for (question of questions; track question.id) {
          <swiper-slide>
            <!-- <p>{{question | json }}</p> -->
            <mat-card class="question-card">
              <h3 class="mb-3">{{ question.title }}</h3>

              @for (choice of question.choices; track choice) {
              <div (click)="optionSelected(choice, question)" class="choice p-2 rounded mb-2" [ngClass]="{
         'selected': question.selectedChoice === choice,
         'correct': question.selectedChoice === choice && choice === question.correctAnswer,
         'wrong': question.selectedChoice === choice && choice !== question.correctAnswer
       }">
                <div class="d-flex justify-content-between align-items-center">
                  <span>{{ choice }}</span>

                  @if (question.selectedChoice === choice && choice === question.correctAnswer) {
                  <img src="assets/images/icons/ic_correct.png" class="icon-right">
                  }
                  @if (question.selectedChoice === choice && choice !== question.correctAnswer) {
                  <img src="assets/images/icons/ic_wrong.png" class="icon-wrong">
                  }
                </div>
              </div>
              }

            </mat-card>
          </swiper-slide>
          }
        </swiper-container>
        }
      </div>

      <!-- FOOTER -->
      <mat-toolbar color="accent" class="footer-toolbar">
        <div class="container-fluid">
          <div class="row w-100">
            <div class="col-4 text-start">
              <button mat-raised-button color="warn" (click)="onSlidePrev()">Skip</button>
            </div>
            <div class="col-4 text-center">
              <button mat-raised-button color="primary" (click)="showHint()">Hint</button>
            </div>
            <div class="col-4 text-end">
              <button mat-raised-button color="primary" (click)="onSlideNext()">
                {{ currentQuestionId === questions.length - 1 ? 'Complete' : 'Next' }}
              </button>
            </div>
          </div>
        </div>
      </mat-toolbar>

    </div>
  </div>
</div>